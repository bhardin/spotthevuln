---
layout: post
title: Sacred Facts
tags:
- Code Snippet
- PHP
status: publish
type: post
published: true
meta:
  aktt_notify_twitter: 'no'
  _aktt_hash_meta: ''
  _edit_last: '2'
  _headspace_page_title: Vulnerable Source Code
  _headspace_description: Can you identify the security vulnerability in this code
    snippet?
  _sexybookmarks_permaHash: 35665155f04282c61b4e12b0676ca3a9
  _sexybookmarks_shortUrl: http://bit.ly/2AXMfv
---
<blockquote>Comments are free but facts are sacred.
- Charles Prestwich Scott</blockquote>
[ccnLe_php]

function _wp_dashboard_recent_comments_row( &amp;$comment, $show_date = true ) {
$GLOBALS['comment'] =&amp; $comment;

$comment_post_url = get_edit_post_link( $comment-&gt;comment_post_ID );
$comment_post_title = get_the_title( $comment-&gt;comment_post_ID );
$comment_post_link = "&lt;a href='$comment_post_url'&gt;$comment_post_title&lt;/a&gt;";
$comment_link = '&lt;a href="' . get_comment_link() . '"&gt;#&lt;/a&gt;';

$delete_url = clean_url( wp_nonce_url( "comment.php?action=deletecomment&amp;p=$comment-&gt;comment_post_ID&amp;c=$comment-&gt;comment_ID", "delete-comment_$comment-&gt;comment_ID" ) );
$approve_url = clean_url( wp_nonce_url( "comment.php?action=approvecomment&amp;p=$comment-&gt;comment_post_ID&amp;c=$comment-&gt;comment_ID", "approve-comment_$comment-&gt;comment_ID" ) );
$unapprove_url = clean_url( wp_nonce_url( "comment.php?action=unapprovecomment&amp;p=$comment-&gt;comment_post_ID&amp;c=$comment-&gt;comment_ID", "unapprove-comment_$comment-&gt;comment_ID" ) );
$spam_url = clean_url( wp_nonce_url( "comment.php?action=deletecomment&amp;dt=spam&amp;p=$comment-&gt;comment_post_ID&amp;c=$comment-&gt;comment_ID", "delete-comment_$comment-&gt;comment_ID" ) );

$actions = array();

$actions_string = '';
if ( current_user_can('edit_post', $comment-&gt;comment_post_ID) ) {
$actions['approve'] = "&lt;a href='$approve_url' class='dim:the-comment-list:comment-$comment-&gt;comment_ID:unapproved:e7e7d3:e7e7d3:new=approved vim-a' title='" . __( 'Approve this comment' ) . "'&gt;" . __( 'Approve' ) . '&lt;/a&gt;';
$actions['unapprove'] = "&lt;a href='$unapprove_url' class='dim:the-comment-list:comment-$comment-&gt;comment_ID:unapproved:e7e7d3:e7e7d3:new=unapproved vim-u' title='" . __( 'Unapprove this comment' ) . "'&gt;" . __( 'Unapprove' ) . '&lt;/a&gt;';
$actions['edit'] = "&lt;a href='comment.php?action=editcomment&amp;amp;c={$comment-&gt;comment_ID}' title='" . __('Edit comment') . "'&gt;". __('Edit') . '&lt;/a&gt;';
//$actions['quickedit'] = '&lt;a onclick="commentReply.open(\''.$comment-&gt;comment_ID.'\',\''.$comment-&gt;comment_post_ID.'\',\'edit\');return false;" title="'.__('Quick Edit').'" href="#"&gt;' . __('Quick&amp;nbsp;Edit') . '&lt;/a&gt;';
$actions['reply'] = '&lt;a onclick="commentReply.open(\''.$comment-&gt;comment_ID.'\',\''.$comment-&gt;comment_post_ID.'\');return false;" title="'.__('Reply to this comment').'" href="#"&gt;' . __('Reply') . '&lt;/a&gt;';
$actions['spam'] = "&lt;a href='$spam_url' class='delete:the-comment-list:comment-$comment-&gt;comment_ID::spam=1 vim-s vim-destructive' title='" . __( 'Mark this comment as spam' ) . "'&gt;" . /* translators: mark as spam link */Â  _x( 'Spam', 'verb' ) . '&lt;/a&gt;';
$actions['delete'] = "&lt;a href='$delete_url' class='delete:the-comment-list:comment-$comment-&gt;comment_ID delete vim-d vim-destructive'&gt;" . __('Delete') . '&lt;/a&gt;';

$actions = apply_filters( 'comment_row_actions', $actions, $comment );

$i = 0;
[/ccnLe_php] 
